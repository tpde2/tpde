; NOTE: Assertions have been autogenerated by test/update_tpde_llc_test_checks.py UTC_ARGS: --tool tpde_test --version 5
; SPDX-FileCopyrightText: 2025 Contributors to TPDE <https://tpde.org>
; SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

; RUN: tpde_test --target=x86_64 %s --no-fixed-assignments | %objdump | FileCheck %s --check-prefixes=X64
; RUN: tpde_test --target=aarch64 %s --no-fixed-assignments | %objdump | FileCheck %s --check-prefixes=ARM64

define @eq(%a, %b) {
; X64-LABEL: <eq>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovne rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <eq>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, eq
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 0
  ret %res
}

define @neq(%a, %b) {
; X64-LABEL: <neq>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmove rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <neq>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, ne
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 1
  ret %res
}

define @uge(%a, %b) {
; X64-LABEL: <uge>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovb rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <uge>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, hs
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 2
  ret %res
}

define @ugt(%a, %b) {
; X64-LABEL: <ugt>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovbe rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <ugt>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, hi
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 3
  ret %res
}

define @ule(%a, %b) {
; X64-LABEL: <ule>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmova rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <ule>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, ls
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 4
  ret %res
}

define @ult(%a, %b) {
; X64-LABEL: <ult>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovae rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <ult>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, lo
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 5
  ret %res
}

define @sge(%a, %b) {
; X64-LABEL: <sge>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovl rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <sge>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, ge
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 6
  ret %res
}

define @sgt(%a, %b) {
; X64-LABEL: <sgt>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovle rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <sgt>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, gt
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 7
  ret %res
}

define @sle(%a, %b) {
; X64-LABEL: <sle>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovg rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <sle>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, le
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 8
  ret %res
}

define @slt(%a, %b) {
; X64-LABEL: <slt>:
; X64:         push rbp
; X64-NEXT:    mov rbp, rsp
; X64-NEXT:    nop word ptr [rax + rax]
; X64-NEXT:    nop dword ptr [rax]
; X64-NEXT:    cmp rdi, rsi
; X64-NEXT:    cmovge rdi, rsi
; X64-NEXT:    mov rax, rdi
; X64-NEXT:    pop rbp
; X64-NEXT:    ret
;
; ARM64-LABEL: <slt>:
; ARM64:         stp x29, x30, [sp, #-0xa0]!
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp x0, x1
; ARM64-NEXT:    csel x0, x0, x1, lt
; ARM64-NEXT:    ldp x29, x30, [sp], #0xa0
; ARM64-NEXT:    ret
entry:
  %res = condselect %a, %b, %a, %b, 9
  ret %res
}
