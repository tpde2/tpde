; NOTE: Assertions have been autogenerated by test/update_tpde_llc_test_checks.py UTC_ARGS: --version 5
; SPDX-FileCopyrightText: 2025 Contributors to TPDE <https://tpde.org>
; SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

; RUN: tpde-llc --target=x86_64 %s | %objdump | FileCheck %s -check-prefixes=X64
; RUN: tpde-llc --target=aarch64 %s | %objdump | FileCheck %s -check-prefixes=ARM64

@glob = internal global i32 5, align 4

define <4 x i32> @retv4i32_zero() {
; X64-LABEL: <retv4i32_zero>:
; X64:         pxor xmm0, xmm0
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_zero>:
; ARM64:         movi v0.16b, #0x0
; ARM64-NEXT:    ret
  ret <4 x i32> zeroinitializer
}

define <4 x i32> @retv4i32_poison() {
; X64-LABEL: <retv4i32_poison>:
; X64:         pxor xmm0, xmm0
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_poison>:
; ARM64:         movi v0.16b, #0x0
; ARM64-NEXT:    ret
  ret <4 x i32> poison
}

define <4 x i32> @retv4i32_allones() {
; X64-LABEL: <retv4i32_allones>:
; X64:         pcmpeqb xmm0, xmm0
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_allones>:
; ARM64:         movi v0.16b, #0xff
; ARM64-NEXT:    ret
  ret <4 x i32> <i32 -1, i32 -1, i32 -1, i32 -1>
}

define <4 x i32> @retv4i32_values() {
; X64-LABEL: <retv4i32_values>:
; X64:         movaps xmm0, xmmword ptr <retv4i32_allones+0xf>
; X64-NEXT:     R_X86_64_PC32 -0x4
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_values>:
; ARM64:         adrp x16, 0x0 <retv4i32_zero>
; ARM64-NEXT:     R_AARCH64_ADR_PREL_PG_HI21
; ARM64-NEXT:    ldr q0, [x16]
; ARM64-NEXT:     R_AARCH64_LDST128_ABS_LO12_NC
; ARM64-NEXT:    ret
  ret <4 x i32> <i32 1, i32 12, i32 123, i32 1234>
}

define <4 x i32> @retv4i32_multiplepoison() {
; X64-LABEL: <retv4i32_multiplepoison>:
; X64:         pxor xmm0, xmm0
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_multiplepoison>:
; ARM64:         movi v0.16b, #0x0
; ARM64-NEXT:    ret
  ret <4 x i32> <i32 poison, i32 poison, i32 poison, i32 poison>
}

define <4 x i32> @retv4i32_mixedpoison() {
; X64-LABEL: <retv4i32_mixedpoison>:
; X64:         movaps xmm0, xmmword ptr <retv4i32_multiplepoison+0xf>
; X64-NEXT:     R_X86_64_PC32 -0x4
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_mixedpoison>:
; ARM64:         adrp x16, 0x0 <retv4i32_zero>
; ARM64-NEXT:     R_AARCH64_ADR_PREL_PG_HI21
; ARM64-NEXT:    ldr q0, [x16]
; ARM64-NEXT:     R_AARCH64_LDST128_ABS_LO12_NC
; ARM64-NEXT:    ret
  ret <4 x i32> <i32 1, i32 poison, i32 123, i32 poison>
}

define <4 x i32> @retv4i32_mixedpoisonzero() {
; X64-LABEL: <retv4i32_mixedpoisonzero>:
; X64:         pxor xmm0, xmm0
; X64-NEXT:    ret
;
; ARM64-LABEL: <retv4i32_mixedpoisonzero>:
; ARM64:         movi v0.16b, #0x0
; ARM64-NEXT:    ret
  ret <4 x i32> <i32 0, i32 poison, i32 0, i32 poison>
}

