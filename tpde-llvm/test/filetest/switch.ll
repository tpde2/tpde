; NOTE: Assertions have been autogenerated by test/update_tpde_llc_test_checks.py UTC_ARGS: --version 5
; SPDX-FileCopyrightText: 2025 Contributors to TPDE <https://tpde.org>
;
; SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

; RUN: tpde-llc --target=x86_64 %s | llvm-objdump -d -r --symbolize-operands --x86-asm-syntax=intel - | FileCheck %s -check-prefixes=X64
; RUN: tpde-llc --target=aarch64 %s | %objdump | FileCheck %s -check-prefixes=ARM64

define i32 @empty_switch(i32 %0) {
; X64-LABEL: <empty_switch>:
; X64:         0: 55 push rbp
; X64-NEXT:    1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    14: e9 00 00 00 00 jmp <L0>
; X64-NEXT:  <L0>:
; X64-NEXT:    19: e9 00 00 00 00 jmp <L1>
; X64-NEXT:  <L1>:
; X64-NEXT:    1e: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    23: 5d pop rbp
; X64-NEXT:    24: c3 ret
; X64-NEXT:    25: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2e: 66 90 nop
;
; ARM64-LABEL: <empty_switch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    b 0x34 <empty_switch+0x14>
; ARM64-NEXT:    b 0x38 <empty_switch+0x18>
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default []
default:
  ret i32 -1
}

define i32 @basic_switch(i32 %0) {
; X64-LABEL: <basic_switch>:
; X64:         30: 55 push rbp
; X64-NEXT:    31: 48 89 e5 mov rbp, rsp
; X64-NEXT:    34: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    44: 83 ff 00 cmp edi, 0x0
; X64-NEXT:    47: 0f 84 1c 00 00 00 je <L0>
; X64-NEXT:    4d: 83 ff 01 cmp edi, 0x1
; X64-NEXT:    50: 0f 84 18 00 00 00 je <L1>
; X64-NEXT:    56: 83 ff 02 cmp edi, 0x2
; X64-NEXT:    59: 0f 84 14 00 00 00 je <L2>
; X64-NEXT:    5f: e9 00 00 00 00 jmp <L3>
; X64-NEXT:  <L3>:
; X64-NEXT:    64: e9 66 00 00 00 jmp <L4>
; X64-NEXT:  <L0>:
; X64-NEXT:    69: e9 0a 00 00 00 jmp <L5>
; X64-NEXT:  <L1>:
; X64-NEXT:    6e: e9 20 00 00 00 jmp <L6>
; X64-NEXT:  <L2>:
; X64-NEXT:    73: e9 39 00 00 00 jmp <L7>
; X64-NEXT:  <L5>:
; X64-NEXT:    78: 31 c0 xor eax, eax
; X64-NEXT:    7a: 5d pop rbp
; X64-NEXT:    7b: c3 ret
; X64-NEXT:    7c: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    85: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    8e: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L6>:
; X64-NEXT:    93: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    98: 5d pop rbp
; X64-NEXT:    99: c3 ret
; X64-NEXT:    9a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    a3: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    ac: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L7>:
; X64-NEXT:    b1: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    b6: 5d pop rbp
; X64-NEXT:    b7: c3 ret
; X64-NEXT:    b8: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    c1: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    ca: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L4>:
; X64-NEXT:    cf: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    d4: 5d pop rbp
; X64-NEXT:    d5: c3 ret
; X64-NEXT:    d6: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    df: 90 nop
;
; ARM64-LABEL: <basic_switch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x0
; ARM64-NEXT:    b.eq 0xa0 <basic_switch+0x30>
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0xa4 <basic_switch+0x34>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0xa8 <basic_switch+0x38>
; ARM64-NEXT:    b 0x9c <basic_switch+0x2c>
; ARM64-NEXT:    b 0x148 <basic_switch+0xd8>
; ARM64-NEXT:    b 0xac <basic_switch+0x3c>
; ARM64-NEXT:    b 0xe0 <basic_switch+0x70>
; ARM64-NEXT:    b 0x114 <basic_switch+0xa4>
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [ i32 0, label %eq0
                                  i32 1, label %eq1
                                  i32 2, label %eq2]
eq0:
  ret i32 0
eq1:
  ret i32 1
eq2:
  ret i32 2
default:
  ret i32 -1
}

define i32 @switch_table(i32 %0) {
; x64-label: switch_table>:
; x64:    b0: 55 push rbp
; x64:    b1: 48 89 e5 mov rbp, rsp
; x64:    b4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; x64:    bd: 48 81 ec 10 00 00 00 sub rsp, 0x10
; x64:    c4: 83 ff 06 cmp edi, 0x6
; x64:    c7: 0f 87 2f 00 00 00 ja <l0>
; x64:    cd: 89 ff mov edi, edi
; x64:    cf: 48 8d 05 0a 00 00 00 lea rax, <switch_table+0x30>
; x64:    d6: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; x64:    da: 48 01 f8 add rax, rdi
; x64:    dd: ff e0 jmp rax
; x64:    df: 00 21 add byte ptr [rcx], ah
; x64:    e1: 00 00 add byte ptr [rax], al
; x64:    e3: 00 26 add byte ptr [rsi], ah
; x64:    e5: 00 00 add byte ptr [rax], al
; x64:    e7: 00 2b add byte ptr [rbx], ch
; x64:    e9: 00 00 add byte ptr [rax], al
; x64:    eb: 00 1c 00 add byte ptr [rax + rax], bl
; x64:    ee: 00 00 add byte ptr [rax], al
; x64:    f0: 30 00 xor byte ptr [rax], al
; x64:    f2: 00 00 add byte ptr [rax], al
; x64:    f4: 35 00 00 00 3a xor eax, 0x3a000000
; x64:    f9: 00 00 add byte ptr [rax], al
; x64:    fb: 00 e9 add cl, ch
; x64:    fd: a8 00 test al, 0x0
; x64:    ff: 00 00 add byte ptr [rax], al
; x64:    101: e9 19 00 00 00 jmp <l1>
; x64:    106: e9 2b 00 00 00 jmp <l2>
; x64:    10b: e9 3d 00 00 00 jmp <l3>
; x64:    110: e9 4f 00 00 00 jmp <l4>
; x64:    115: e9 61 00 00 00 jmp <l5>
; x64:    11a: e9 73 00 00 00 jmp <l6>
; x64:  <l1>:
; x64:    11f: b8 00 00 00 00 mov eax, 0x0
; x64:    124: 48 83 c4 10 add rsp, 0x10
; x64:    128: 5d pop rbp
; x64:    129: c3 ret
; x64:  <l2>:
; x64:    136: b8 01 00 00 00 mov eax, 0x1
; x64:    13b: 48 83 c4 10 add rsp, 0x10
; x64:    13f: 5d pop rbp
; x64:    140: c3 ret
; x64:  <l3>:
; x64:    14d: b8 02 00 00 00 mov eax, 0x2
; x64:    152: 48 83 c4 10 add rsp, 0x10
; x64:    156: 5d pop rbp
; x64:    157: c3 ret
; x64:  <l4>:
; x64:    164: b8 04 00 00 00 mov eax, 0x4
; x64:    169: 48 83 c4 10 add rsp, 0x10
; x64:    16d: 5d pop rbp
; x64:    16e: c3 ret
; x64:  <l5>:
; x64:    17b: b8 05 00 00 00 mov eax, 0x5
; x64:    180: 48 83 c4 10 add rsp, 0x10
; x64:    184: 5d pop rbp
; x64:    185: c3 ret
; x64:  <l6>:
; x64:    192: b8 06 00 00 00 mov eax, 0x6
; x64:    197: 48 83 c4 10 add rsp, 0x10
; x64:    19b: 5d pop rbp
; x64:    19c: c3 ret
; x64:    1a9: b8 ff ff ff ff mov eax, 0xffffffff
; x64:    1ae: 48 83 c4 10 add rsp, 0x10
; x64:    1b2: 5d pop rbp
; x64:    1b3: c3 ret
; x64:     ...
; X64-LABEL: <switch_table>:
; X64:         e0: 55 push rbp
; X64-NEXT:    e1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    e4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    ed: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    f4: 83 ff 06 cmp edi, 0x6
; X64-NEXT:    f7: 0f 87 2f 00 00 00 ja <L0>
; X64-NEXT:    fd: 89 ff mov edi, edi
; X64-NEXT:    ff: 48 8d 05 0a 00 00 00 lea rax, <switch_table+0x30>
; X64-NEXT:    106: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; X64-NEXT:    10a: 48 01 f8 add rax, rdi
; X64-NEXT:    10d: ff e0 jmp rax
; X64-NEXT:    10f: 90 nop
; X64-NEXT:    110: 21 00 and dword ptr [rax], eax
; X64-NEXT:    112: 00 00 add byte ptr [rax], al
; X64-NEXT:    114: 26 00 00 add byte ptr es:[rax], al
; X64-NEXT:    117: 00 2b add byte ptr [rbx], ch
; X64-NEXT:    119: 00 00 add byte ptr [rax], al
; X64-NEXT:    11b: 00 1c 00 add byte ptr [rax + rax], bl
; X64-NEXT:    11e: 00 00 add byte ptr [rax], al
; X64-NEXT:    120: 30 00 xor byte ptr [rax], al
; X64-NEXT:    122: 00 00 add byte ptr [rax], al
; X64-NEXT:    124: 35 00 00 00 3a xor eax, 0x3a000000
; X64-NEXT:    129: 00 00 add byte ptr [rax], al
; X64-NEXT:    12b: 00 e9 add cl, ch
; X64-NEXT:    12d: cf iretd
; X64-NEXT:    12e: 00 00 add byte ptr [rax], al
; X64-NEXT:    130: 00 e9 add cl, ch
; X64-NEXT:    132: 19 00 sbb dword ptr [rax], eax
; X64-NEXT:    134: 00 00 add byte ptr [rax], al
; X64-NEXT:    136: e9 2f 00 00 00 jmp <L1>
; X64-NEXT:    13b: e9 48 00 00 00 jmp <L2>
; X64-NEXT:    140: e9 61 00 00 00 jmp <L3>
; X64-NEXT:    145: e9 7a 00 00 00 jmp <L4>
; X64-NEXT:    14a: e9 93 00 00 00 jmp <L5>
; X64-NEXT:    14f: 31 c0 xor eax, eax
; X64-NEXT:    151: 5d pop rbp
; X64-NEXT:    152: c3 ret
; X64-NEXT:    153: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    15c: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    165: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L1>:
; X64-NEXT:    16a: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    16f: 5d pop rbp
; X64-NEXT:    170: c3 ret
; X64-NEXT:    171: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    17a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    183: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L2>:
; X64-NEXT:    188: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    18d: 5d pop rbp
; X64-NEXT:    18e: c3 ret
; X64-NEXT:    18f: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    198: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1a1: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    1a6: b8 04 00 00 00 mov eax, 0x4
; X64-NEXT:    1ab: 5d pop rbp
; X64-NEXT:    1ac: c3 ret
; X64-NEXT:    1ad: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1b6: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1bf: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L4>:
; X64-NEXT:    1c4: b8 05 00 00 00 mov eax, 0x5
; X64-NEXT:    1c9: 5d pop rbp
; X64-NEXT:    1ca: c3 ret
; X64-NEXT:    1cb: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1d4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1dd: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L5>:
; X64-NEXT:    1e2: b8 06 00 00 00 mov eax, 0x6
; X64-NEXT:    1e7: 5d pop rbp
; X64-NEXT:    1e8: c3 ret
; X64-NEXT:    1e9: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1f2: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1fb: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    200: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    205: 5d pop rbp
; X64-NEXT:    206: c3 ret
; X64-NEXT:    207: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
;
; ARM64-LABEL: <switch_table>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x4
; ARM64-NEXT:    b.eq 0x1dc <switch_table+0x5c>
; ARM64-NEXT:    b.hi 0x1b8 <switch_table+0x38>
; ARM64-NEXT:    cmp w0, #0x0
; ARM64-NEXT:    b.eq 0x1d0 <switch_table+0x50>
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0x1d4 <switch_table+0x54>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x1d8 <switch_table+0x58>
; ARM64-NEXT:    b 0x1cc <switch_table+0x4c>
; ARM64-NEXT:    cmp w0, #0x5
; ARM64-NEXT:    b.eq 0x1e0 <switch_table+0x60>
; ARM64-NEXT:    cmp w0, #0x6
; ARM64-NEXT:    b.eq 0x1e4 <switch_table+0x64>
; ARM64-NEXT:    b 0x1cc <switch_table+0x4c>
; ARM64-NEXT:    b 0x320 <switch_table+0x1a0>
; ARM64-NEXT:    b 0x1e8 <switch_table+0x68>
; ARM64-NEXT:    b 0x21c <switch_table+0x9c>
; ARM64-NEXT:    b 0x250 <switch_table+0xd0>
; ARM64-NEXT:    b 0x284 <switch_table+0x104>
; ARM64-NEXT:    b 0x2b8 <switch_table+0x138>
; ARM64-NEXT:    b 0x2ec <switch_table+0x16c>
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x4 // =4
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x5 // =5
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x6 // =6
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 0, label %eq0
    i32 1, label %eq1
    i32 2, label %eq2
    i32 4, label %eq4
    i32 5, label %eq5
    i32 6, label %eq6]
eq0:
  ret i32 0
eq1:
  ret i32 1
eq2:
  ret i32 2
eq4:
  ret i32 4
eq5:
  ret i32 5
eq6:
  ret i32 6
default:
  ret i32 -1
}

define i32 @switch_table2(i32 %0) {
; X64-LABEL: <switch_table2>:
; X64:         210: 55 push rbp
; X64-NEXT:    211: 48 89 e5 mov rbp, rsp
; X64-NEXT:    214: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    21d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    224: 83 ff 03 cmp edi, 0x3
; X64-NEXT:    227: 0f 82 3b 00 00 00 jb <L0>
; X64-NEXT:    22d: 83 ff 09 cmp edi, 0x9
; X64-NEXT:    230: 0f 87 32 00 00 00 ja <L0>
; X64-NEXT:    236: 89 ff mov edi, edi
; X64-NEXT:    238: 48 83 ef 03 sub rdi, 0x3
; X64-NEXT:    23c: 48 8d 05 09 00 00 00 lea rax, <switch_table2+0x3c>
; X64-NEXT:    243: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; X64-NEXT:    247: 48 01 f8 add rax, rdi
; X64-NEXT:    24a: ff e0 jmp rax
; X64-NEXT:    24c: 21 00 and dword ptr [rax], eax
; X64-NEXT:    24e: 00 00 add byte ptr [rax], al
; X64-NEXT:    250: 26 00 00 add byte ptr es:[rax], al
; X64-NEXT:    253: 00 2b add byte ptr [rbx], ch
; X64-NEXT:    255: 00 00 add byte ptr [rax], al
; X64-NEXT:    257: 00 1c 00 add byte ptr [rax + rax], bl
; X64-NEXT:    25a: 00 00 add byte ptr [rax], al
; X64-NEXT:    25c: 30 00 xor byte ptr [rax], al
; X64-NEXT:    25e: 00 00 add byte ptr [rax], al
; X64-NEXT:    260: 35 00 00 00 3a xor eax, 0x3a000000
; X64-NEXT:    265: 00 00 add byte ptr [rax], al
; X64-NEXT:    267: 00 e9 add cl, ch
; X64-NEXT:    269: d2 00 rol byte ptr [rax], cl
; X64-NEXT:    26b: 00 00 add byte ptr [rax], al
; X64-NEXT:    26d: e9 19 00 00 00 jmp <L1>
; X64-NEXT:    272: e9 32 00 00 00 jmp <L2>
; X64-NEXT:    277: e9 4b 00 00 00 jmp <L3>
; X64-NEXT:    27c: e9 64 00 00 00 jmp <L4>
; X64-NEXT:    281: e9 7d 00 00 00 jmp <L5>
; X64-NEXT:    286: e9 96 00 00 00 jmp <L6>
; X64-NEXT:  <L1>:
; X64-NEXT:    28b: b8 03 00 00 00 mov eax, 0x3
; X64-NEXT:    290: 5d pop rbp
; X64-NEXT:    291: c3 ret
; X64-NEXT:    292: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    29b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2a4: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L2>:
; X64-NEXT:    2a9: b8 04 00 00 00 mov eax, 0x4
; X64-NEXT:    2ae: 5d pop rbp
; X64-NEXT:    2af: c3 ret
; X64-NEXT:    2b0: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2b9: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2c2: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    2c7: b8 05 00 00 00 mov eax, 0x5
; X64-NEXT:    2cc: 5d pop rbp
; X64-NEXT:    2cd: c3 ret
; X64-NEXT:    2ce: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2d7: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2e0: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L4>:
; X64-NEXT:    2e5: b8 07 00 00 00 mov eax, 0x7
; X64-NEXT:    2ea: 5d pop rbp
; X64-NEXT:    2eb: c3 ret
; X64-NEXT:    2ec: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2f5: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2fe: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L5>:
; X64-NEXT:    303: b8 08 00 00 00 mov eax, 0x8
; X64-NEXT:    308: 5d pop rbp
; X64-NEXT:    309: c3 ret
; X64-NEXT:    30a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    313: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    31c: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L6>:
; X64-NEXT:    321: b8 09 00 00 00 mov eax, 0x9
; X64-NEXT:    326: 5d pop rbp
; X64-NEXT:    327: c3 ret
; X64-NEXT:    328: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    331: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    33a: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    33f: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    344: 5d pop rbp
; X64-NEXT:    345: c3 ret
; X64-NEXT:    346: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    34f: 90 nop
;
; ARM64-LABEL: <switch_table2>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x7
; ARM64-NEXT:    b.eq 0x3ac <switch_table2+0x5c>
; ARM64-NEXT:    b.hi 0x388 <switch_table2+0x38>
; ARM64-NEXT:    cmp w0, #0x3
; ARM64-NEXT:    b.eq 0x3a0 <switch_table2+0x50>
; ARM64-NEXT:    cmp w0, #0x4
; ARM64-NEXT:    b.eq 0x3a4 <switch_table2+0x54>
; ARM64-NEXT:    cmp w0, #0x5
; ARM64-NEXT:    b.eq 0x3a8 <switch_table2+0x58>
; ARM64-NEXT:    b 0x39c <switch_table2+0x4c>
; ARM64-NEXT:    cmp w0, #0x8
; ARM64-NEXT:    b.eq 0x3b0 <switch_table2+0x60>
; ARM64-NEXT:    cmp w0, #0x9
; ARM64-NEXT:    b.eq 0x3b4 <switch_table2+0x64>
; ARM64-NEXT:    b 0x39c <switch_table2+0x4c>
; ARM64-NEXT:    b 0x4f0 <switch_table2+0x1a0>
; ARM64-NEXT:    b 0x3b8 <switch_table2+0x68>
; ARM64-NEXT:    b 0x3ec <switch_table2+0x9c>
; ARM64-NEXT:    b 0x420 <switch_table2+0xd0>
; ARM64-NEXT:    b 0x454 <switch_table2+0x104>
; ARM64-NEXT:    b 0x488 <switch_table2+0x138>
; ARM64-NEXT:    b 0x4bc <switch_table2+0x16c>
; ARM64-NEXT:    mov x0, #0x3 // =3
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x4 // =4
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x5 // =5
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x7 // =7
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x8 // =8
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x9 // =9
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 3, label %eq3
    i32 4, label %eq4
    i32 5, label %eq5
    i32 7, label %eq7
    i32 8, label %eq8
    i32 9, label %eq9]
eq3:
  ret i32 3
eq4:
  ret i32 4
eq5:
  ret i32 5
eq7:
  ret i32 7
eq8:
  ret i32 8
eq9:
  ret i32 9
default:
  ret i32 -1
}


define i32 @switch_binsearch(i32 %0) {
; X64-LABEL: <switch_binsearch>:
; X64:         350: 55 push rbp
; X64-NEXT:    351: 48 89 e5 mov rbp, rsp
; X64-NEXT:    354: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    35d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    364: 83 ff 03 cmp edi, 0x3
; X64-NEXT:    367: 0f 84 43 00 00 00 je <L0>
; X64-NEXT:    36d: 0f 87 17 00 00 00 ja <L1>
; X64-NEXT:    373: 83 ff 01 cmp edi, 0x1
; X64-NEXT:    376: 0f 84 2a 00 00 00 je <L2>
; X64-NEXT:    37c: 83 ff 02 cmp edi, 0x2
; X64-NEXT:    37f: 0f 84 26 00 00 00 je <L3>
; X64-NEXT:    385: e9 17 00 00 00 jmp <L4>
; X64-NEXT:  <L1>:
; X64-NEXT:    38a: 83 ff 64 cmp edi, 0x64
; X64-NEXT:    38d: 0f 84 22 00 00 00 je <L5>
; X64-NEXT:    393: 83 ff 65 cmp edi, 0x65
; X64-NEXT:    396: 0f 84 1e 00 00 00 je <L6>
; X64-NEXT:    39c: e9 00 00 00 00 jmp <L4>
; X64-NEXT:  <L4>:
; X64-NEXT:    3a1: e9 af 00 00 00 jmp <L7>
; X64-NEXT:  <L2>:
; X64-NEXT:    3a6: e9 14 00 00 00 jmp <L8>
; X64-NEXT:  <L3>:
; X64-NEXT:    3ab: e9 2d 00 00 00 jmp <L9>
; X64-NEXT:  <L0>:
; X64-NEXT:    3b0: e9 46 00 00 00 jmp <L10>
; X64-NEXT:  <L5>:
; X64-NEXT:    3b5: e9 5f 00 00 00 jmp <L11>
; X64-NEXT:  <L6>:
; X64-NEXT:    3ba: e9 78 00 00 00 jmp <L12>
; X64-NEXT:  <L8>:
; X64-NEXT:    3bf: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    3c4: 5d pop rbp
; X64-NEXT:    3c5: c3 ret
; X64-NEXT:    3c6: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3cf: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3d8: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L9>:
; X64-NEXT:    3dd: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    3e2: 5d pop rbp
; X64-NEXT:    3e3: c3 ret
; X64-NEXT:    3e4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3ed: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3f6: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L10>:
; X64-NEXT:    3fb: b8 03 00 00 00 mov eax, 0x3
; X64-NEXT:    400: 5d pop rbp
; X64-NEXT:    401: c3 ret
; X64-NEXT:    402: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    40b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    414: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L11>:
; X64-NEXT:    419: b8 64 00 00 00 mov eax, 0x64
; X64-NEXT:    41e: 5d pop rbp
; X64-NEXT:    41f: c3 ret
; X64-NEXT:    420: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    429: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    432: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L12>:
; X64-NEXT:    437: b8 65 00 00 00 mov eax, 0x65
; X64-NEXT:    43c: 5d pop rbp
; X64-NEXT:    43d: c3 ret
; X64-NEXT:    43e: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    447: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    450: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L7>:
; X64-NEXT:    455: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    45a: 5d pop rbp
; X64-NEXT:    45b: c3 ret
; X64-NEXT:    45c: 0f 1f 40 00 nop dword ptr [rax]
;
; ARM64-LABEL: <switch_binsearch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x3
; ARM64-NEXT:    b.eq 0x570 <switch_binsearch+0x50>
; ARM64-NEXT:    b.hi 0x550 <switch_binsearch+0x30>
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0x568 <switch_binsearch+0x48>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x56c <switch_binsearch+0x4c>
; ARM64-NEXT:    b 0x564 <switch_binsearch+0x44>
; ARM64-NEXT:    cmp w0, #0x64
; ARM64-NEXT:    b.eq 0x574 <switch_binsearch+0x54>
; ARM64-NEXT:    cmp w0, #0x65
; ARM64-NEXT:    b.eq 0x578 <switch_binsearch+0x58>
; ARM64-NEXT:    b 0x564 <switch_binsearch+0x44>
; ARM64-NEXT:    b 0x680 <switch_binsearch+0x160>
; ARM64-NEXT:    b 0x57c <switch_binsearch+0x5c>
; ARM64-NEXT:    b 0x5b0 <switch_binsearch+0x90>
; ARM64-NEXT:    b 0x5e4 <switch_binsearch+0xc4>
; ARM64-NEXT:    b 0x618 <switch_binsearch+0xf8>
; ARM64-NEXT:    b 0x64c <switch_binsearch+0x12c>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x3 // =3
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x64 // =100
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x65 // =101
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 1, label %eq1
    i32 2, label %eq2
    i32 3, label %eq3
    i32 100, label %eq100
    i32 101, label %eq101
  ]
eq1:
  ret i32 1
eq2:
  ret i32 2
eq3:
  ret i32 3
eq100:
  ret i32 100
eq101:
  ret i32 101
default:
  ret i32 -1
}

define i32 @switch_i32_noreuse(i32 %p) {
; X64-LABEL: <switch_i32_noreuse>:
; X64:         460: 55 push rbp
; X64-NEXT:    461: 48 89 e5 mov rbp, rsp
; X64-NEXT:    464: 53 push rbx
; X64-NEXT:    465: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    46e: 66 0f 1f 44 00 00 nop word ptr [rax + rax]
; X64-NEXT:    474: 89 fb mov ebx, edi
; X64-NEXT:    476: 89 d8 mov eax, ebx
; X64-NEXT:    478: 83 f8 01 cmp eax, 0x1
; X64-NEXT:    47b: 0f 84 13 00 00 00 je <L0>
; X64-NEXT:    481: 83 f8 02 cmp eax, 0x2
; X64-NEXT:    484: 0f 84 0f 00 00 00 je <L1>
; X64-NEXT:    48a: e9 00 00 00 00 jmp <L2>
; X64-NEXT:  <L2>:
; X64-NEXT:    48f: e9 46 00 00 00 jmp <L3>
; X64-NEXT:  <L0>:
; X64-NEXT:    494: e9 05 00 00 00 jmp <L4>
; X64-NEXT:  <L1>:
; X64-NEXT:    499: e9 1e 00 00 00 jmp <L5>
; X64-NEXT:  <L4>:
; X64-NEXT:    49e: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    4a3: 5b pop rbx
; X64-NEXT:    4a4: 5d pop rbp
; X64-NEXT:    4a5: c3 ret
; X64-NEXT:    4a6: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4af: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4b8: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L5>:
; X64-NEXT:    4bc: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    4c1: 5b pop rbx
; X64-NEXT:    4c2: 5d pop rbp
; X64-NEXT:    4c3: c3 ret
; X64-NEXT:    4c4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4cd: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4d6: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    4da: 89 d8 mov eax, ebx
; X64-NEXT:    4dc: 5b pop rbx
; X64-NEXT:    4dd: 5d pop rbp
; X64-NEXT:    4de: c3 ret
; X64-NEXT:    4df: 90 nop
;
; ARM64-LABEL: <switch_i32_noreuse>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    str x19, [sp, #0x10]
; ARM64-NEXT:    mov w19, w0
; ARM64-NEXT:    mov w0, w19
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0x6e0 <switch_i32_noreuse+0x30>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x6e4 <switch_i32_noreuse+0x34>
; ARM64-NEXT:    b 0x6dc <switch_i32_noreuse+0x2c>
; ARM64-NEXT:    b 0x750 <switch_i32_noreuse+0xa0>
; ARM64-NEXT:    b 0x6e8 <switch_i32_noreuse+0x38>
; ARM64-NEXT:    b 0x71c <switch_i32_noreuse+0x6c>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov w0, w19
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
  switch i32 %p, label %default [
    i32 1, label %l1
    i32 2, label %l2
  ]
l1:
  ret i32 1
l2:
  ret i32 2
default:
  ret i32 %p
}

define i64 @switch_i64_noreuse(i64 %p) {
; X64-LABEL: <switch_i64_noreuse>:
; X64:         4e0: 55 push rbp
; X64-NEXT:    4e1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    4e4: 53 push rbx
; X64-NEXT:    4e5: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4ee: 66 0f 1f 44 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4f4: 48 89 fb mov rbx, rdi
; X64-NEXT:    4f7: 48 89 d8 mov rax, rbx
; X64-NEXT:    4fa: 48 83 f8 01 cmp rax, 0x1
; X64-NEXT:    4fe: 0f 84 14 00 00 00 je <L0>
; X64-NEXT:    504: 48 83 f8 02 cmp rax, 0x2
; X64-NEXT:    508: 0f 84 0f 00 00 00 je <L1>
; X64-NEXT:    50e: e9 00 00 00 00 jmp <L2>
; X64-NEXT:  <L2>:
; X64-NEXT:    513: e9 46 00 00 00 jmp <L3>
; X64-NEXT:  <L0>:
; X64-NEXT:    518: e9 05 00 00 00 jmp <L4>
; X64-NEXT:  <L1>:
; X64-NEXT:    51d: e9 1e 00 00 00 jmp <L5>
; X64-NEXT:  <L4>:
; X64-NEXT:    522: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    527: 5b pop rbx
; X64-NEXT:    528: 5d pop rbp
; X64-NEXT:    529: c3 ret
; X64-NEXT:    52a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    533: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    53c: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L5>:
; X64-NEXT:    540: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    545: 5b pop rbx
; X64-NEXT:    546: 5d pop rbp
; X64-NEXT:    547: c3 ret
; X64-NEXT:    548: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    551: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    55a: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    55e: 48 89 d8 mov rax, rbx
; X64-NEXT:    561: 5b pop rbx
; X64-NEXT:    562: 5d pop rbp
; X64-NEXT:    563: c3 ret
;
; ARM64-LABEL: <switch_i64_noreuse>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    str x19, [sp, #0x10]
; ARM64-NEXT:    mov x19, x0
; ARM64-NEXT:    mov x0, x19
; ARM64-NEXT:    cmp x0, #0x1
; ARM64-NEXT:    b.eq 0x7c0 <switch_i64_noreuse+0x30>
; ARM64-NEXT:    cmp x0, #0x2
; ARM64-NEXT:    b.eq 0x7c4 <switch_i64_noreuse+0x34>
; ARM64-NEXT:    b 0x7bc <switch_i64_noreuse+0x2c>
; ARM64-NEXT:    b 0x830 <switch_i64_noreuse+0xa0>
; ARM64-NEXT:    b 0x7c8 <switch_i64_noreuse+0x38>
; ARM64-NEXT:    b 0x7fc <switch_i64_noreuse+0x6c>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, x19
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
  switch i64 %p, label %default [
    i64 1, label %l1
    i64 2, label %l2
  ]
l1:
  ret i64 1
l2:
  ret i64 2
default:
  ret i64 %p
}

