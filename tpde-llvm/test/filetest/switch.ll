; NOTE: Assertions have been autogenerated by test/update_tpde_llc_test_checks.py UTC_ARGS: --version 5
; SPDX-FileCopyrightText: 2025 Contributors to TPDE <https://tpde.org>
;
; SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

; RUN: tpde-llc --target=x86_64 %s | llvm-objdump -d -r --symbolize-operands --x86-asm-syntax=intel - | FileCheck %s -check-prefixes=X64
; RUN: tpde-llc --target=aarch64 %s | %objdump | FileCheck %s -check-prefixes=ARM64

define i32 @empty_switch(i32 %0) {
; X64-LABEL: <empty_switch>:
; X64:         0: 55 push rbp
; X64-NEXT:    1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    14: e9 00 00 00 00 jmp <L0>
; X64-NEXT:  <L0>:
; X64-NEXT:    19: e9 00 00 00 00 jmp <L1>
; X64-NEXT:  <L1>:
; X64-NEXT:    1e: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    23: 5d pop rbp
; X64-NEXT:    24: c3 ret
; X64-NEXT:    25: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2e: 66 90 nop
;
; ARM64-LABEL: <empty_switch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    b 0x34 <empty_switch+0x14>
; ARM64-NEXT:    b 0x38 <empty_switch+0x18>
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default []
default:
  ret i32 -1
}

define i32 @basic_switch(i32 %0) {
; X64-LABEL: <basic_switch>:
; X64:         30: 55 push rbp
; X64-NEXT:    31: 48 89 e5 mov rbp, rsp
; X64-NEXT:    34: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    44: 83 ff 00 cmp edi, 0x0
; X64-NEXT:    47: 0f 84 1c 00 00 00 je <L0>
; X64-NEXT:    4d: 83 ff 01 cmp edi, 0x1
; X64-NEXT:    50: 0f 84 2e 00 00 00 je <L1>
; X64-NEXT:    56: 83 ff 02 cmp edi, 0x2
; X64-NEXT:    59: 0f 84 43 00 00 00 je <L2>
; X64-NEXT:    5f: e9 00 00 00 00 jmp <L3>
; X64-NEXT:  <L3>:
; X64-NEXT:    64: e9 57 00 00 00 jmp <L4>
; X64-NEXT:  <L0>:
; X64-NEXT:    69: 31 c0 xor eax, eax
; X64-NEXT:    6b: 5d pop rbp
; X64-NEXT:    6c: c3 ret
; X64-NEXT:    6d: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    76: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    7f: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L1>:
; X64-NEXT:    84: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    89: 5d pop rbp
; X64-NEXT:    8a: c3 ret
; X64-NEXT:    8b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    94: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    9d: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L2>:
; X64-NEXT:    a2: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    a7: 5d pop rbp
; X64-NEXT:    a8: c3 ret
; X64-NEXT:    a9: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    b2: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    bb: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L4>:
; X64-NEXT:    c0: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    c5: 5d pop rbp
; X64-NEXT:    c6: c3 ret
; X64-NEXT:    c7: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
;
; ARM64-LABEL: <basic_switch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x0
; ARM64-NEXT:    b.eq 0xa0 <basic_switch+0x30>
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0xd4 <basic_switch+0x64>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x108 <basic_switch+0x98>
; ARM64-NEXT:    b 0x9c <basic_switch+0x2c>
; ARM64-NEXT:    b 0x13c <basic_switch+0xcc>
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [ i32 0, label %eq0
                                  i32 1, label %eq1
                                  i32 2, label %eq2]
eq0:
  ret i32 0
eq1:
  ret i32 1
eq2:
  ret i32 2
default:
  ret i32 -1
}

define i32 @switch_table(i32 %0) {
; x64-label: switch_table>:
; x64:    b0: 55 push rbp
; x64:    b1: 48 89 e5 mov rbp, rsp
; x64:    b4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; x64:    bd: 48 81 ec 10 00 00 00 sub rsp, 0x10
; x64:    c4: 83 ff 06 cmp edi, 0x6
; x64:    c7: 0f 87 2f 00 00 00 ja <l0>
; x64:    cd: 89 ff mov edi, edi
; x64:    cf: 48 8d 05 0a 00 00 00 lea rax, <switch_table+0x30>
; x64:    d6: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; x64:    da: 48 01 f8 add rax, rdi
; x64:    dd: ff e0 jmp rax
; x64:    df: 00 21 add byte ptr [rcx], ah
; x64:    e1: 00 00 add byte ptr [rax], al
; x64:    e3: 00 26 add byte ptr [rsi], ah
; x64:    e5: 00 00 add byte ptr [rax], al
; x64:    e7: 00 2b add byte ptr [rbx], ch
; x64:    e9: 00 00 add byte ptr [rax], al
; x64:    eb: 00 1c 00 add byte ptr [rax + rax], bl
; x64:    ee: 00 00 add byte ptr [rax], al
; x64:    f0: 30 00 xor byte ptr [rax], al
; x64:    f2: 00 00 add byte ptr [rax], al
; x64:    f4: 35 00 00 00 3a xor eax, 0x3a000000
; x64:    f9: 00 00 add byte ptr [rax], al
; x64:    fb: 00 e9 add cl, ch
; x64:    fd: a8 00 test al, 0x0
; x64:    ff: 00 00 add byte ptr [rax], al
; x64:    101: e9 19 00 00 00 jmp <l1>
; x64:    106: e9 2b 00 00 00 jmp <l2>
; x64:    10b: e9 3d 00 00 00 jmp <l3>
; x64:    110: e9 4f 00 00 00 jmp <l4>
; x64:    115: e9 61 00 00 00 jmp <l5>
; x64:    11a: e9 73 00 00 00 jmp <l6>
; x64:  <l1>:
; x64:    11f: b8 00 00 00 00 mov eax, 0x0
; x64:    124: 48 83 c4 10 add rsp, 0x10
; x64:    128: 5d pop rbp
; x64:    129: c3 ret
; x64:  <l2>:
; x64:    136: b8 01 00 00 00 mov eax, 0x1
; x64:    13b: 48 83 c4 10 add rsp, 0x10
; x64:    13f: 5d pop rbp
; x64:    140: c3 ret
; x64:  <l3>:
; x64:    14d: b8 02 00 00 00 mov eax, 0x2
; x64:    152: 48 83 c4 10 add rsp, 0x10
; x64:    156: 5d pop rbp
; x64:    157: c3 ret
; x64:  <l4>:
; x64:    164: b8 04 00 00 00 mov eax, 0x4
; x64:    169: 48 83 c4 10 add rsp, 0x10
; x64:    16d: 5d pop rbp
; x64:    16e: c3 ret
; x64:  <l5>:
; x64:    17b: b8 05 00 00 00 mov eax, 0x5
; x64:    180: 48 83 c4 10 add rsp, 0x10
; x64:    184: 5d pop rbp
; x64:    185: c3 ret
; x64:  <l6>:
; x64:    192: b8 06 00 00 00 mov eax, 0x6
; x64:    197: 48 83 c4 10 add rsp, 0x10
; x64:    19b: 5d pop rbp
; x64:    19c: c3 ret
; x64:    1a9: b8 ff ff ff ff mov eax, 0xffffffff
; x64:    1ae: 48 83 c4 10 add rsp, 0x10
; x64:    1b2: 5d pop rbp
; x64:    1b3: c3 ret
; x64:     ...
; X64-LABEL: <switch_table>:
; X64:         d0: 55 push rbp
; X64-NEXT:    d1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    d4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    dd: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    e4: 83 ff 06 cmp edi, 0x6
; X64-NEXT:    e7: 0f 87 2f 00 00 00 ja <L0>
; X64-NEXT:    ed: 89 ff mov edi, edi
; X64-NEXT:    ef: 48 8d 05 0a 00 00 00 lea rax, <switch_table+0x30>
; X64-NEXT:    f6: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; X64-NEXT:    fa: 48 01 f8 add rax, rdi
; X64-NEXT:    fd: ff e0 jmp rax
; X64-NEXT:    ff: 90 nop
; X64-NEXT:    100: 21 00 and dword ptr [rax], eax
; X64-NEXT:    102: 00 00 add byte ptr [rax], al
; X64-NEXT:    104: 3c 00 cmp al, 0x0
; X64-NEXT:    106: 00 00 add byte ptr [rax], al
; X64-NEXT:    108: 5a pop rdx
; X64-NEXT:    109: 00 00 add byte ptr [rax], al
; X64-NEXT:    10b: 00 1c 00 add byte ptr [rax + rax], bl
; X64-NEXT:    10e: 00 00 add byte ptr [rax], al
; X64-NEXT:    110: 78 00 js <L1>
; X64-NEXT:  <L1>:
; X64-NEXT:    112: 00 00 add byte ptr [rax], al
; X64-NEXT:    114: 96 xchg eax, esi
; X64-NEXT:    115: 00 00 add byte ptr [rax], al
; X64-NEXT:    117: 00 b4 00 00 00 e9 b1 add byte ptr [rax + rax - 0x4e170000], dh
; X64-NEXT:    11e: 00 00 add byte ptr [rax], al
; X64-NEXT:    120: 00 31 add byte ptr [rcx], dh
; X64-NEXT:    122: c0 5d c3 66 rcr byte ptr [rbp - 0x3d], 0x66
; X64-NEXT:    126: 0f 1f 84 00 00 00 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    12e: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    137: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    13c: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    141: 5d pop rbp
; X64-NEXT:    142: c3 ret
; X64-NEXT:    143: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    14c: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    155: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    15a: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    15f: 5d pop rbp
; X64-NEXT:    160: c3 ret
; X64-NEXT:    161: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    16a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    173: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    178: b8 04 00 00 00 mov eax, 0x4
; X64-NEXT:    17d: 5d pop rbp
; X64-NEXT:    17e: c3 ret
; X64-NEXT:    17f: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    188: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    191: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    196: b8 05 00 00 00 mov eax, 0x5
; X64-NEXT:    19b: 5d pop rbp
; X64-NEXT:    19c: c3 ret
; X64-NEXT:    19d: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1a6: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1af: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    1b4: b8 06 00 00 00 mov eax, 0x6
; X64-NEXT:    1b9: 5d pop rbp
; X64-NEXT:    1ba: c3 ret
; X64-NEXT:    1bb: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1c4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1cd: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    1d2: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    1d7: 5d pop rbp
; X64-NEXT:    1d8: c3 ret
; X64-NEXT:    1d9: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
;
; ARM64-LABEL: <switch_table>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x6
; ARM64-NEXT:    b.hi 0x1b4 <switch_table+0x44>
; ARM64-NEXT:    adr x1, 0x198 <switch_table+0x28>
; ARM64-NEXT:    ldrsw x0, [x1, w0, uxtw #2]
; ARM64-NEXT:    add x1, x1, x0
; ARM64-NEXT:    br x1
; ARM64-NEXT:    udf #0x20
; ARM64-NEXT:    udf #0x54
; ARM64-NEXT:    udf #0x88
; ARM64-NEXT:    udf #0x1c
; ARM64-NEXT:    udf #0xbc
; ARM64-NEXT:    udf #0xf0
; ARM64-NEXT:    udf #0x124
; ARM64-NEXT:    b 0x2f0 <switch_table+0x180>
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x4 // =4
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x5 // =5
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x6 // =6
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 0, label %eq0
    i32 1, label %eq1
    i32 2, label %eq2
    i32 4, label %eq4
    i32 5, label %eq5
    i32 6, label %eq6]
eq0:
  ret i32 0
eq1:
  ret i32 1
eq2:
  ret i32 2
eq4:
  ret i32 4
eq5:
  ret i32 5
eq6:
  ret i32 6
default:
  ret i32 -1
}

define i32 @switch_table2(i32 %0) {
; X64-LABEL: <switch_table2>:
; X64:         1e0: 55 push rbp
; X64-NEXT:    1e1: 48 89 e5 mov rbp, rsp
; X64-NEXT:    1e4: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    1ed: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    1f4: 83 ff 03 cmp edi, 0x3
; X64-NEXT:    1f7: 0f 82 3b 00 00 00 jb <L0>
; X64-NEXT:    1fd: 83 ff 09 cmp edi, 0x9
; X64-NEXT:    200: 0f 87 32 00 00 00 ja <L0>
; X64-NEXT:    206: 89 ff mov edi, edi
; X64-NEXT:    208: 48 83 ef 03 sub rdi, 0x3
; X64-NEXT:    20c: 48 8d 05 09 00 00 00 lea rax, <switch_table2+0x3c>
; X64-NEXT:    213: 48 63 3c b8 movsxd rdi, dword ptr [rax + 4*rdi]
; X64-NEXT:    217: 48 01 f8 add rax, rdi
; X64-NEXT:    21a: ff e0 jmp rax
; X64-NEXT:    21c: 21 00 and dword ptr [rax], eax
; X64-NEXT:    21e: 00 00 add byte ptr [rax], al
; X64-NEXT:    220: 3f <unknown>
; X64-NEXT:    221: 00 00 add byte ptr [rax], al
; X64-NEXT:    223: 00 5d 00 add byte ptr [rbp], bl
; X64-NEXT:    226: 00 00 add byte ptr [rax], al
; X64-NEXT:    228: 1c 00 sbb al, 0x0
; X64-NEXT:    22a: 00 00 add byte ptr [rax], al
; X64-NEXT:    22c: 7b 00 jnp <L1>
; X64-NEXT:  <L1>:
; X64-NEXT:    22e: 00 00 add byte ptr [rax], al
; X64-NEXT:    230: 99 cdq
; X64-NEXT:    231: 00 00 add byte ptr [rax], al
; X64-NEXT:    233: 00 b7 00 00 00 e9 add byte ptr [rdi - 0x17000000], dh
; X64-NEXT:    239: b4 00 mov ah, 0x0
; X64-NEXT:    23b: 00 00 add byte ptr [rax], al
; X64-NEXT:    23d: b8 03 00 00 00 mov eax, 0x3
; X64-NEXT:    242: 5d pop rbp
; X64-NEXT:    243: c3 ret
; X64-NEXT:    244: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    24d: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    256: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    25b: b8 04 00 00 00 mov eax, 0x4
; X64-NEXT:    260: 5d pop rbp
; X64-NEXT:    261: c3 ret
; X64-NEXT:    262: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    26b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    274: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    279: b8 05 00 00 00 mov eax, 0x5
; X64-NEXT:    27e: 5d pop rbp
; X64-NEXT:    27f: c3 ret
; X64-NEXT:    280: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    289: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    292: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    297: b8 07 00 00 00 mov eax, 0x7
; X64-NEXT:    29c: 5d pop rbp
; X64-NEXT:    29d: c3 ret
; X64-NEXT:    29e: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2a7: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2b0: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    2b5: b8 08 00 00 00 mov eax, 0x8
; X64-NEXT:    2ba: 5d pop rbp
; X64-NEXT:    2bb: c3 ret
; X64-NEXT:    2bc: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2c5: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2ce: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    2d3: b8 09 00 00 00 mov eax, 0x9
; X64-NEXT:    2d8: 5d pop rbp
; X64-NEXT:    2d9: c3 ret
; X64-NEXT:    2da: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2e3: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    2ec: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    2f1: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    2f6: 5d pop rbp
; X64-NEXT:    2f7: c3 ret
; X64-NEXT:    2f8: 0f 1f 84 00 00 00 00 00 nop dword ptr [rax + rax]
;
; ARM64-LABEL: <switch_table2>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x3
; ARM64-NEXT:    b.lo 0x370 <switch_table2+0x50>
; ARM64-NEXT:    cmp w0, #0x9
; ARM64-NEXT:    b.hi 0x370 <switch_table2+0x50>
; ARM64-NEXT:    sub x0, x0, #0x3
; ARM64-NEXT:    adr x1, 0x354 <switch_table2+0x34>
; ARM64-NEXT:    ldrsw x0, [x1, w0, uxtw #2]
; ARM64-NEXT:    add x1, x1, x0
; ARM64-NEXT:    br x1
; ARM64-NEXT:    udf #0x20
; ARM64-NEXT:    udf #0x54
; ARM64-NEXT:    udf #0x88
; ARM64-NEXT:    udf #0x1c
; ARM64-NEXT:    udf #0xbc
; ARM64-NEXT:    udf #0xf0
; ARM64-NEXT:    udf #0x124
; ARM64-NEXT:    b 0x4ac <switch_table2+0x18c>
; ARM64-NEXT:    mov x0, #0x3 // =3
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x4 // =4
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x5 // =5
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x7 // =7
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x8 // =8
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x9 // =9
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 3, label %eq3
    i32 4, label %eq4
    i32 5, label %eq5
    i32 7, label %eq7
    i32 8, label %eq8
    i32 9, label %eq9]
eq3:
  ret i32 3
eq4:
  ret i32 4
eq5:
  ret i32 5
eq7:
  ret i32 7
eq8:
  ret i32 8
eq9:
  ret i32 9
default:
  ret i32 -1
}


define i32 @switch_binsearch(i32 %0) {
; X64-LABEL: <switch_binsearch>:
; X64:         300: 55 push rbp
; X64-NEXT:    301: 48 89 e5 mov rbp, rsp
; X64-NEXT:    304: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    30d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    314: 83 ff 03 cmp edi, 0x3
; X64-NEXT:    317: 0f 84 75 00 00 00 je <L0>
; X64-NEXT:    31d: 0f 87 17 00 00 00 ja <L1>
; X64-NEXT:    323: 83 ff 01 cmp edi, 0x1
; X64-NEXT:    326: 0f 84 2a 00 00 00 je <L2>
; X64-NEXT:    32c: 83 ff 02 cmp edi, 0x2
; X64-NEXT:    32f: 0f 84 3f 00 00 00 je <L3>
; X64-NEXT:    335: e9 17 00 00 00 jmp <L4>
; X64-NEXT:  <L1>:
; X64-NEXT:    33a: 83 ff 64 cmp edi, 0x64
; X64-NEXT:    33d: 0f 84 6d 00 00 00 je <L5>
; X64-NEXT:    343: 83 ff 65 cmp edi, 0x65
; X64-NEXT:    346: 0f 84 82 00 00 00 je <L6>
; X64-NEXT:    34c: e9 00 00 00 00 jmp <L4>
; X64-NEXT:  <L4>:
; X64-NEXT:    351: e9 96 00 00 00 jmp <L7>
; X64-NEXT:  <L2>:
; X64-NEXT:    356: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    35b: 5d pop rbp
; X64-NEXT:    35c: c3 ret
; X64-NEXT:    35d: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    366: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    36f: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    374: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    379: 5d pop rbp
; X64-NEXT:    37a: c3 ret
; X64-NEXT:    37b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    384: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    38d: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L0>:
; X64-NEXT:    392: b8 03 00 00 00 mov eax, 0x3
; X64-NEXT:    397: 5d pop rbp
; X64-NEXT:    398: c3 ret
; X64-NEXT:    399: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3a2: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3ab: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L5>:
; X64-NEXT:    3b0: b8 64 00 00 00 mov eax, 0x64
; X64-NEXT:    3b5: 5d pop rbp
; X64-NEXT:    3b6: c3 ret
; X64-NEXT:    3b7: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3c0: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3c9: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L6>:
; X64-NEXT:    3ce: b8 65 00 00 00 mov eax, 0x65
; X64-NEXT:    3d3: 5d pop rbp
; X64-NEXT:    3d4: c3 ret
; X64-NEXT:    3d5: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3de: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3e7: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L7>:
; X64-NEXT:    3ec: b8 ff ff ff ff mov eax, 0xffffffff
; X64-NEXT:    3f1: 5d pop rbp
; X64-NEXT:    3f2: c3 ret
; X64-NEXT:    3f3: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    3fc: 0f 1f 40 00 nop dword ptr [rax]
;
; ARM64-LABEL: <switch_binsearch>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    cmp w0, #0x3
; ARM64-NEXT:    b.eq 0x590 <switch_binsearch+0xb0>
; ARM64-NEXT:    b.hi 0x510 <switch_binsearch+0x30>
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0x528 <switch_binsearch+0x48>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x55c <switch_binsearch+0x7c>
; ARM64-NEXT:    b 0x524 <switch_binsearch+0x44>
; ARM64-NEXT:    cmp w0, #0x64
; ARM64-NEXT:    b.eq 0x5c4 <switch_binsearch+0xe4>
; ARM64-NEXT:    cmp w0, #0x65
; ARM64-NEXT:    b.eq 0x5f8 <switch_binsearch+0x118>
; ARM64-NEXT:    b 0x524 <switch_binsearch+0x44>
; ARM64-NEXT:    b 0x62c <switch_binsearch+0x14c>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x3 // =3
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x64 // =100
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x65 // =101
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0xffffffff // =4294967295
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
entry:
  switch i32 %0, label %default [
    i32 1, label %eq1
    i32 2, label %eq2
    i32 3, label %eq3
    i32 100, label %eq100
    i32 101, label %eq101
  ]
eq1:
  ret i32 1
eq2:
  ret i32 2
eq3:
  ret i32 3
eq100:
  ret i32 100
eq101:
  ret i32 101
default:
  ret i32 -1
}

define i32 @switch_i32_noreuse(i32 %p) {
; X64-LABEL: <switch_i32_noreuse>:
; X64:         400: 55 push rbp
; X64-NEXT:    401: 48 89 e5 mov rbp, rsp
; X64-NEXT:    404: 53 push rbx
; X64-NEXT:    405: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    40e: 66 0f 1f 44 00 00 nop word ptr [rax + rax]
; X64-NEXT:    414: 89 fb mov ebx, edi
; X64-NEXT:    416: 89 d8 mov eax, ebx
; X64-NEXT:    418: 83 f8 01 cmp eax, 0x1
; X64-NEXT:    41b: 0f 84 13 00 00 00 je <L0>
; X64-NEXT:    421: 83 f8 02 cmp eax, 0x2
; X64-NEXT:    424: 0f 84 28 00 00 00 je <L1>
; X64-NEXT:    42a: e9 00 00 00 00 jmp <L2>
; X64-NEXT:  <L2>:
; X64-NEXT:    42f: e9 3c 00 00 00 jmp <L3>
; X64-NEXT:  <L0>:
; X64-NEXT:    434: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    439: 5b pop rbx
; X64-NEXT:    43a: 5d pop rbp
; X64-NEXT:    43b: c3 ret
; X64-NEXT:    43c: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    445: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    44e: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L1>:
; X64-NEXT:    452: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    457: 5b pop rbx
; X64-NEXT:    458: 5d pop rbp
; X64-NEXT:    459: c3 ret
; X64-NEXT:    45a: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    463: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    46c: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    470: 89 d8 mov eax, ebx
; X64-NEXT:    472: 5b pop rbx
; X64-NEXT:    473: 5d pop rbp
; X64-NEXT:    474: c3 ret
; X64-NEXT:    475: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    47e: 66 90 nop
;
; ARM64-LABEL: <switch_i32_noreuse>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    str x19, [sp, #0x10]
; ARM64-NEXT:    mov w19, w0
; ARM64-NEXT:    mov w0, w19
; ARM64-NEXT:    cmp w0, #0x1
; ARM64-NEXT:    b.eq 0x690 <switch_i32_noreuse+0x30>
; ARM64-NEXT:    cmp w0, #0x2
; ARM64-NEXT:    b.eq 0x6c4 <switch_i32_noreuse+0x64>
; ARM64-NEXT:    b 0x68c <switch_i32_noreuse+0x2c>
; ARM64-NEXT:    b 0x6f8 <switch_i32_noreuse+0x98>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov w0, w19
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
  switch i32 %p, label %default [
    i32 1, label %l1
    i32 2, label %l2
  ]
l1:
  ret i32 1
l2:
  ret i32 2
default:
  ret i32 %p
}

define i64 @switch_i64_noreuse(i64 %p) {
; X64-LABEL: <switch_i64_noreuse>:
; X64:         480: 55 push rbp
; X64-NEXT:    481: 48 89 e5 mov rbp, rsp
; X64-NEXT:    484: 53 push rbx
; X64-NEXT:    485: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    48e: 66 0f 1f 44 00 00 nop word ptr [rax + rax]
; X64-NEXT:    494: 48 89 fb mov rbx, rdi
; X64-NEXT:    497: 48 89 d8 mov rax, rbx
; X64-NEXT:    49a: 48 83 f8 01 cmp rax, 0x1
; X64-NEXT:    49e: 0f 84 14 00 00 00 je <L0>
; X64-NEXT:    4a4: 48 83 f8 02 cmp rax, 0x2
; X64-NEXT:    4a8: 0f 84 28 00 00 00 je <L1>
; X64-NEXT:    4ae: e9 00 00 00 00 jmp <L2>
; X64-NEXT:  <L2>:
; X64-NEXT:    4b3: e9 3c 00 00 00 jmp <L3>
; X64-NEXT:  <L0>:
; X64-NEXT:    4b8: b8 01 00 00 00 mov eax, 0x1
; X64-NEXT:    4bd: 5b pop rbx
; X64-NEXT:    4be: 5d pop rbp
; X64-NEXT:    4bf: c3 ret
; X64-NEXT:    4c0: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4c9: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4d2: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L1>:
; X64-NEXT:    4d6: b8 02 00 00 00 mov eax, 0x2
; X64-NEXT:    4db: 5b pop rbx
; X64-NEXT:    4dc: 5d pop rbp
; X64-NEXT:    4dd: c3 ret
; X64-NEXT:    4de: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4e7: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    4f0: 0f 1f 40 00 nop dword ptr [rax]
; X64-NEXT:  <L3>:
; X64-NEXT:    4f4: 48 89 d8 mov rax, rbx
; X64-NEXT:    4f7: 5b pop rbx
; X64-NEXT:    4f8: 5d pop rbp
; X64-NEXT:    4f9: c3 ret
; X64-NEXT:    4fa: 66 0f 1f 44 00 00 nop word ptr [rax + rax]
;
; ARM64-LABEL: <switch_i64_noreuse>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    str x19, [sp, #0x10]
; ARM64-NEXT:    mov x19, x0
; ARM64-NEXT:    mov x0, x19
; ARM64-NEXT:    cmp x0, #0x1
; ARM64-NEXT:    b.eq 0x760 <switch_i64_noreuse+0x30>
; ARM64-NEXT:    cmp x0, #0x2
; ARM64-NEXT:    b.eq 0x794 <switch_i64_noreuse+0x64>
; ARM64-NEXT:    b 0x75c <switch_i64_noreuse+0x2c>
; ARM64-NEXT:    b 0x7c8 <switch_i64_noreuse+0x98>
; ARM64-NEXT:    mov x0, #0x1 // =1
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, #0x2 // =2
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov x0, x19
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    ldr x19, [sp, #0x10]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
  switch i64 %p, label %default [
    i64 1, label %l1
    i64 2, label %l2
  ]
l1:
  ret i64 1
l2:
  ret i64 2
default:
  ret i64 %p
}

define i32 @switch_to_self() {
; X64-LABEL: <switch_to_self>:
; X64:         500: 55 push rbp
; X64-NEXT:    501: 48 89 e5 mov rbp, rsp
; X64-NEXT:    504: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    50d: 0f 1f 80 00 00 00 00 nop dword ptr [rax]
; X64-NEXT:    514: 31 c0 xor eax, eax
; X64-NEXT:    516: 83 f8 35 cmp eax, 0x35
; X64-NEXT:    519: 0f 84 70 01 00 00 je <L0>
; X64-NEXT:    51f: 0f 87 d7 00 00 00 ja <L1>
; X64-NEXT:    525: 83 f8 0a cmp eax, 0xa
; X64-NEXT:    528: 0f 82 0b 01 00 00 jb <L2>
; X64-NEXT:    52e: 83 f8 34 cmp eax, 0x34
; X64-NEXT:    531: 0f 87 02 01 00 00 ja <L2>
; X64-NEXT:    537: 89 c0 mov eax, eax
; X64-NEXT:    539: 48 83 e8 0a sub rax, 0xa
; X64-NEXT:    53d: 48 8d 0d 0c 00 00 00 lea rcx, <switch_to_self+0x50>
; X64-NEXT:    544: 48 63 04 81 movsxd rax, dword ptr [rcx + 4*rax]
; X64-NEXT:    548: 48 01 c1 add rcx, rax
; X64-NEXT:    54b: ff e1 jmp rcx
; X64-NEXT:    54d: 0f 1f 00 nop dword ptr [rax]
; X64-NEXT:    550: c4 ff ff <unknown>
; X64-NEXT:    553: ff e9 <unknown>
; X64-NEXT:    555: 00 00 add byte ptr [rax], al
; X64-NEXT:    557: 00 e9 add cl, ch
; X64-NEXT:    559: 00 00 add byte ptr [rax], al
; X64-NEXT:    55b: 00 e9 add cl, ch
; X64-NEXT:    55d: 00 00 add byte ptr [rax], al
; X64-NEXT:    55f: 00 e9 add cl, ch
; X64-NEXT:    561: 00 00 add byte ptr [rax], al
; X64-NEXT:    563: 00 e9 add cl, ch
; X64-NEXT:    565: 00 00 add byte ptr [rax], al
; X64-NEXT:    567: 00 e9 add cl, ch
; X64-NEXT:    569: 00 00 add byte ptr [rax], al
; X64-NEXT:    56b: 00 e9 add cl, ch
; X64-NEXT:    56d: 00 00 add byte ptr [rax], al
; X64-NEXT:    56f: 00 e9 add cl, ch
; X64-NEXT:    571: 00 00 add byte ptr [rax], al
; X64-NEXT:    573: 00 e9 add cl, ch
; X64-NEXT:    575: 00 00 add byte ptr [rax], al
; X64-NEXT:    577: 00 e9 add cl, ch
; X64-NEXT:    579: 00 00 add byte ptr [rax], al
; X64-NEXT:    57b: 00 e9 add cl, ch
; X64-NEXT:    57d: 00 00 add byte ptr [rax], al
; X64-NEXT:    57f: 00 e9 add cl, ch
; X64-NEXT:    581: 00 00 add byte ptr [rax], al
; X64-NEXT:    583: 00 e9 add cl, ch
; X64-NEXT:    585: 00 00 add byte ptr [rax], al
; X64-NEXT:    587: 00 e9 add cl, ch
; X64-NEXT:    589: 00 00 add byte ptr [rax], al
; X64-NEXT:    58b: 00 e9 add cl, ch
; X64-NEXT:    58d: 00 00 add byte ptr [rax], al
; X64-NEXT:    58f: 00 e9 add cl, ch
; X64-NEXT:    591: 00 00 add byte ptr [rax], al
; X64-NEXT:    593: 00 e9 add cl, ch
; X64-NEXT:    595: 00 00 add byte ptr [rax], al
; X64-NEXT:    597: 00 e9 add cl, ch
; X64-NEXT:    599: 00 00 add byte ptr [rax], al
; X64-NEXT:    59b: 00 e9 add cl, ch
; X64-NEXT:    59d: 00 00 add byte ptr [rax], al
; X64-NEXT:    59f: 00 e9 add cl, ch
; X64-NEXT:    5a1: 00 00 add byte ptr [rax], al
; X64-NEXT:    5a3: 00 e9 add cl, ch
; X64-NEXT:    5a5: 00 00 add byte ptr [rax], al
; X64-NEXT:    5a7: 00 e9 add cl, ch
; X64-NEXT:    5a9: 00 00 add byte ptr [rax], al
; X64-NEXT:    5ab: 00 e9 add cl, ch
; X64-NEXT:    5ad: 00 00 add byte ptr [rax], al
; X64-NEXT:    5af: 00 e9 add cl, ch
; X64-NEXT:    5b1: 00 00 add byte ptr [rax], al
; X64-NEXT:    5b3: 00 e9 add cl, ch
; X64-NEXT:    5b5: 00 00 add byte ptr [rax], al
; X64-NEXT:    5b7: 00 e9 add cl, ch
; X64-NEXT:    5b9: 00 00 add byte ptr [rax], al
; X64-NEXT:    5bb: 00 e9 add cl, ch
; X64-NEXT:    5bd: 00 00 add byte ptr [rax], al
; X64-NEXT:    5bf: 00 e9 add cl, ch
; X64-NEXT:    5c1: 00 00 add byte ptr [rax], al
; X64-NEXT:    5c3: 00 e9 add cl, ch
; X64-NEXT:    5c5: 00 00 add byte ptr [rax], al
; X64-NEXT:    5c7: 00 e9 add cl, ch
; X64-NEXT:    5c9: 00 00 add byte ptr [rax], al
; X64-NEXT:    5cb: 00 e9 add cl, ch
; X64-NEXT:    5cd: 00 00 add byte ptr [rax], al
; X64-NEXT:    5cf: 00 e9 add cl, ch
; X64-NEXT:    5d1: 00 00 add byte ptr [rax], al
; X64-NEXT:    5d3: 00 e9 add cl, ch
; X64-NEXT:    5d5: 00 00 add byte ptr [rax], al
; X64-NEXT:    5d7: 00 e9 add cl, ch
; X64-NEXT:    5d9: 00 00 add byte ptr [rax], al
; X64-NEXT:    5db: 00 e9 add cl, ch
; X64-NEXT:    5dd: 00 00 add byte ptr [rax], al
; X64-NEXT:    5df: 00 e9 add cl, ch
; X64-NEXT:    5e1: 00 00 add byte ptr [rax], al
; X64-NEXT:    5e3: 00 e9 add cl, ch
; X64-NEXT:    5e5: 00 00 add byte ptr [rax], al
; X64-NEXT:    5e7: 00 3f add byte ptr [rdi], bh
; X64-NEXT:    5e9: 01 00 add dword ptr [rax], eax
; X64-NEXT:    5eb: 00 3f add byte ptr [rdi], bh
; X64-NEXT:    5ed: 01 00 add dword ptr [rax], eax
; X64-NEXT:    5ef: 00 3f add byte ptr [rdi], bh
; X64-NEXT:    5f1: 01 00 add dword ptr [rax], eax
; X64-NEXT:    5f3: 00 3f add byte ptr [rdi], bh
; X64-NEXT:    5f5: 01 00 add dword ptr [rax], eax
; X64-NEXT:    5f7: 00 3f add byte ptr [rdi], bh
; X64-NEXT:    5f9: 01 00 add dword ptr [rax], eax
; X64-NEXT:    5fb: 00 83 f8 62 0f 84 add byte ptr [rbx - 0x7bf09d08], al
; X64-NEXT:    601: 54 push rsp
; X64-NEXT:    602: 00 00 add byte ptr [rax], al
; X64-NEXT:    604: 00 0f add byte ptr [rdi], cl
; X64-NEXT:    606: 87 17 xchg dword ptr [rdi], edx
; X64-NEXT:    608: 00 00 add byte ptr [rax], al
; X64-NEXT:    60a: 00 83 f8 36 0f 84 add byte ptr [rbx - 0x7bf0c908], al
; X64-NEXT:    610: 7b 00 jnp <L3>
; X64-NEXT:  <L3>:
; X64-NEXT:    612: 00 00 add byte ptr [rax], al
; X64-NEXT:    614: 83 f8 37 cmp eax, 0x37
; X64-NEXT:    617: 0f 84 72 00 00 00 je <L0>
; X64-NEXT:    61d: e9 17 00 00 00 jmp <L2>
; X64-NEXT:    622: 83 f8 66 cmp eax, 0x66
; X64-NEXT:    625: 0f 84 49 00 00 00 je <L4>
; X64-NEXT:    62b: 83 f8 72 cmp eax, 0x72
; X64-NEXT:    62e: 0f 84 0a 00 00 00 je <L5>
; X64-NEXT:    634: e9 00 00 00 00 jmp <L2>
; X64-NEXT:  <L2>:
; X64-NEXT:    639: e9 51 00 00 00 jmp <L0>
; X64-NEXT:  <L5>:
; X64-NEXT:    63e: 31 c0 xor eax, eax
; X64-NEXT:    640: 5d pop rbp
; X64-NEXT:    641: c3 ret
; X64-NEXT:    642: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    64b: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    654: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:    659: 31 c0 xor eax, eax
; X64-NEXT:    65b: 5d pop rbp
; X64-NEXT:    65c: c3 ret
; X64-NEXT:    65d: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    666: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    66f: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L4>:
; X64-NEXT:    674: 31 c0 xor eax, eax
; X64-NEXT:    676: 5d pop rbp
; X64-NEXT:    677: c3 ret
; X64-NEXT:    678: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    681: 66 0f 1f 84 00 00 00 00 00 nop word ptr [rax + rax]
; X64-NEXT:    68a: 0f 1f 44 00 00 nop dword ptr [rax + rax]
; X64-NEXT:  <L0>:
; X64-NEXT:    68f: 31 c0 xor eax, eax
; X64-NEXT:    691: 5d pop rbp
; X64-NEXT:    692: c3 ret
;
; ARM64-LABEL: <switch_to_self>:
; ARM64:         sub sp, sp, #0xa0
; ARM64-NEXT:    stp x29, x30, [sp]
; ARM64-NEXT:    mov x29, sp
; ARM64-NEXT:    nop
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    cmp w0, #0x35
; ARM64-NEXT:    b.eq 0x9c4 <switch_to_self+0x1c4>
; ARM64-NEXT:    b.hi 0x8f0 <switch_to_self+0xf0>
; ARM64-NEXT:    cmp w0, #0xa
; ARM64-NEXT:    b.lo 0x924 <switch_to_self+0x124>
; ARM64-NEXT:    cmp w0, #0x34
; ARM64-NEXT:    b.hi 0x924 <switch_to_self+0x124>
; ARM64-NEXT:    sub x0, x0, #0xa
; ARM64-NEXT:    adr x1, 0x844 <switch_to_self+0x44>
; ARM64-NEXT:    ldrsw x0, [x1, w0, uxtw #2]
; ARM64-NEXT:    add x1, x1, x0
; ARM64-NEXT:    br x1
; ARM64-NEXT:    <unknown>
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0xe0
; ARM64-NEXT:    udf #0x180
; ARM64-NEXT:    udf #0x180
; ARM64-NEXT:    udf #0x180
; ARM64-NEXT:    udf #0x180
; ARM64-NEXT:    udf #0x180
; ARM64-NEXT:    cmp w0, #0x62
; ARM64-NEXT:    b.eq 0x95c <switch_to_self+0x15c>
; ARM64-NEXT:    b.hi 0x910 <switch_to_self+0x110>
; ARM64-NEXT:    cmp w0, #0x36
; ARM64-NEXT:    b.eq 0x9c4 <switch_to_self+0x1c4>
; ARM64-NEXT:    cmp w0, #0x37
; ARM64-NEXT:    b.eq 0x9c4 <switch_to_self+0x1c4>
; ARM64-NEXT:    b 0x924 <switch_to_self+0x124>
; ARM64-NEXT:    cmp w0, #0x66
; ARM64-NEXT:    b.eq 0x990 <switch_to_self+0x190>
; ARM64-NEXT:    cmp w0, #0x72
; ARM64-NEXT:    b.eq 0x928 <switch_to_self+0x128>
; ARM64-NEXT:    b 0x924 <switch_to_self+0x124>
; ARM64-NEXT:    b 0x9c4 <switch_to_self+0x1c4>
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
; ARM64-NEXT:     ...
; ARM64-NEXT:    mov w0, #0x0 // =0
; ARM64-NEXT:    ldp x29, x30, [sp]
; ARM64-NEXT:    add sp, sp, #0xa0
; ARM64-NEXT:    ret
  br label %1

1:
  switch i32 0, label %5 [
    i32 55, label %5
    i32 114, label %2
    i32 54, label %5
    i32 98, label %3
    i32 102, label %4
    i32 10, label %1
    i32 48, label %5
    i32 49, label %5
    i32 50, label %5
    i32 51, label %5
    i32 52, label %5
    i32 53, label %5
  ]

2:
  ret i32 0

3:
  ret i32 0

4:
  ret i32 0

5:
  ret i32 0
}
